# Task1

## 1. PR を小さくするメリット

### リリース期間の短縮につながるメリット

- 問題発生時のロールバックが楽
- コンフリクトが起こりにくい
- レビュワーの認知負荷軽減
  - 結果的にすぐにレビューしてもらえる
- PR が細かいとレビュー待ちの間に並行して進められる作業がある

### コードの品質におけるメリット

- 問題の見落としが減る
  - 1 回の PR は長くて 1 時間、400 行以内にしようという研究結果もあるそう
  - https://smartbear.com/learn/code-review/best-practices-for-peer-code-review/

### コミュニケーションにおけるメリット

- リモート開発時にそれぞれの動きが把握しやすい
- 単純にコミュニケーション回数が増えることさえもメリットに感じる

## 2. コメントに記載すべきこと、記載しなくていいこと

### 記載すべきこと

- コードを読むだけではわからないこと
  - What（何をしているか）ではなく Why（なぜそのコードが必要になったのか）
    - ただし正規表現や複雑なアルゴリズムなどに関してはコメントが効果的
    - それ以外でコメントが必要なコードは複雑すぎるので改善の余地がある

### 記載しなくていいこと

- コードを読めばわかること
  - 他の何かで管理できないもの
  - クラスや関数の使い方（/\*\* \*/ で書くアレ。IDE では関数を使うときに表示されたり、ドキュメントを自動生成するときにも拾われる）

### [BestPractice](https://stackoverflow.blog/2021/12/23/best-practices-for-writing-code-comments/)

1. コメントはコードと重複してはならない。
2. 良いコメントは不明確なコードの言い訳にはならない。
3. 明確なコメントが書けない場合は、コードに問題がある可能性がある。
4. コメントは混乱を招くものではなく、混乱を払拭するものでなければならない。
5. 慣用的でないコードは、コメントで説明する。
6. コピーしたコードの原典へのリンクを提供する。
7. 最も有用な外部参照へのリンクを含めること．
8. バグを修正するときはコメントをつける
9. コメントで不完全な実装をマークする

## 3. コミットメッセージに書くべきこと

- `プリフィックス`: `変更理由`、`変更したこと`の形式で書く
- プラハチャレンジが始まった頃、[プラハブログ](https://www.praha-inc.com/lab/posts/commit-message)を参照して実践したことがある

```
<!-- sample -->
perf: ユーザ一覧画面の描画速度に問題があったため、データ取得ロジックをリファクタリング

DBからユーザ一覧画面に必要なデータを取得するロジックでN+1が発生していたので、実行しているクエリの条件式でin句を使うように修正

Issue #100
```

- ここまでやるのはかなり手間だった！なので自分は 1 行目だけを意識している・・・。
- ちなみに「これから意識していこう」と思って当時まとめた prefix はこんな感じ

| グループ     | プレフィックス      | 対象                                                               | 機能変更 |
| ------------ | ------------------- | ------------------------------------------------------------------ | -------- |
| 追加         | feat                | 新機能の追加                                                       | あり     |
| 修正         | fix                 | バグ修正                                                           | あり     |
|              | hotfix              | クリティカルバグの修正                                             | あり     |
|              | style               | 空白、セミコロン、行、フォーマットなどのスタイル調整               | なし     |
|              | change              | ファイル名変更、フォルダ移動など                                   |          |
|              | pref                | パフォーマンス改善                                                 | なし     |
|              | refactor            | リファクタリングなど、外部的振る舞いは変更せず、内部構造を改善する | なし     |
|              | upgrade / downgrade | ライブラリなどのアップグレード                                     | なし     |
| ドキュメント | docs                | ドキュメントの編集                                                 | なし     |
| テスト       | test                | テスト関連の追加、修正                                             | なし     |
| ビルド関連   | chore               | ビルドツール、補助ツール、ライブラリ関連の追加、修正               | なし     |
| 削除         | remove              | コードやファイルの削除                                             |          |

- 今見直すと、pref の意味合いのものは refactor としたり、upgrade/downgrade でも chore にしたり、多すぎても使い分けできずに 10 個以内くらいに収まっている。
  - 分けすぎても使いこなせないかも

### おまけ

対話形式でコミットメッセージを記述できる[こんなツール](https://blog.solunita.net/posts/write-easy-neat-git-commit-message/)もあるっぽい。チームで導入すれば嫌でもコミットメッセージの型が定まりそう。
